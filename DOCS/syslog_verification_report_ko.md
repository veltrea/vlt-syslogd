# Syslog 검증 최종 보고서: 실제 툴에서의 인코딩 동작

## 1. 검증 목적
RFC 5424 사양(UTF-8 사용 시 BOM 필수)과 실제 Syslog 전송 유틸리티의 동작 사이에 괴리가 있음을 입증하고, 구현된 "관용적 파싱(Tolerant Parsing)"의 유효성을 확인한다.

## 2. 검증 환경
- **서버**: `vlt-syslog-portable` (Mac 192.168.1.22)
- **클라이언트 1 (Mac)**: `nc` (netcat), `logger`
- **클라이언트 2 (Windows)**: `LLM-SVR1` (PowerShell .NET)

## 3. 검증 결과: 실기기에서의 "Raw 데이터" 분석

`logs/debug_raw.log`에 기록된 수신 패킷(HEX) 분석 결과입니다.

| 전송 툴 / 형식 | 기대되는 동작 (RFC) | 실제 동작 (RAW) | 판정 결과 | 비고 |
| :--- | :--- | :--- | :--- | :--- |
| **Mac `nc` (UTF-8)** | BOM 있음 | **BOM 없음** | ✅ UTF-8 (Implicit) | 수동 전송 시 BOM 누락은 빈번하게 발생 |
| **Windows PowerShell** | BOM 있음 | **BOM 없음** | ✅ UTF-8 (Implicit) | .NET 표준 동작으로 인한 BOM 누락 확인 |
| **MegaLog / 각종 SD** | 지정대로 | 지정대로 | ✅ 각종 Charset | SD `charset` 파라미터는 신뢰성이 높음 |
| **Legacy (RFC 3164)** | 규정 없음 | BOM 없음(SJIS) | ✅ Shift_JIS (Guess) | 통계적 추정으로 SJIS를 올바르게 구제 |

## 4. "BOM의 함정"에 관한 고찰 및 해결책
이번 검증을 통해 **"BOM 유무에만 의존하는 파싱は 실제 운영 환경에서 통하지 않는다"**는 점이 명확해졌습니다.

### 실태
- Windows의 표준적인 전송(PowerShell 등)에서는 UTF-8이라도 BOM을 붙이지 않는 것이 일반적입니다.
- 이를 "BOM이 없으니 SJIS(또는 잘못된 데이터)다"라고 무시하면 현대적인 시스템의 로그가 모두 깨지게 됩니다.

### 당사의 해결책 (3단계 로직)
1. **BOM 검출**: 있으면 100% UTF-8로 처리.
2. **SD(Structured Data) 파싱**: `charset` 태그(`UTF-8`, `MSG-UTF8`, `Shift_JIS` 등)를 분석하여 구제.
3. **통계적 추정 (최후의 보루)**: `chardetng`를 사용하여 바이트 열의 특징으로부터 한국어/CJK 환경에 최적화된 판정을 내림.

## 5. 결론
`vlt-syslog-portable`은 RFC의 이상을 존중しながらも 실제 세계의 "불완전한 데이터"에 대해 매우 높은 내성을 가지고 있음이 입증되었습니다. 이를 통해 멀티 플랫폼 혼재 환경에서도 글자 깨짐 없는 안정적인 로그 모니터링이 가능합니다.

---

> [!IMPORTANT]
> **글로벌 사용자 여러분께 드리는 요청**
> 현재 개발자의 테스트 환경은 **일본어 환경**으로 한정되어 있습니다. 주요 인코딩에 대한 대응은 확인했으나, 각 지역(한국어, 영어, 중국어, 베트남어 등)에서 표시 오류나 "글자 깨짐"이 발생하는 경우 꼭 제보해 주시기 바랍니다. 여러분의 피드백을 기다리고 있습니다.
